<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Money Tracker - Přehled</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="dashboard-body">

    <div class="quick-actions">
        <h4>Quick Actions</h4>
        <div class="action-buttons">
            <button class="action-btn transfer">⇆</button>
            <button class="action-btn expense">-</button>
            <button class="action-btn income">+</button>
        </div>
    </div>

    <main class="main-content">
        <div class="chart-container">
            <div class="donut-chart">
                <div class="chart-center">
                    <span class="main-balance" id="main-balance-display"></span>
                </div>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <input type="checkbox" id="cb-owned" class="legend-checkbox owned" data-value="{{ data.owned }}" checked>
                <label for="cb-owned">Owned</label>
            </div>
            <div class="legend-item">
                <input type="checkbox" id="cb-landed" class="legend-checkbox landed" data-value="{{ data.landed }}" checked>
                <label for="cb-landed">Landed</label>
            </div>
            <div class="legend-item">
                <input type="checkbox" id="cb-owe" class="legend-checkbox owe" data-value="{{ data.owe }}" checked>
                <label for="cb-owe">Owe</label>
            </div>
        </div>
    </main>

    <script>
        // Spustí se, až bude celá stránka načtená
        document.addEventListener('DOMContentLoaded', function() {
            
            // Najdeme si všechny checkboxy a prvek, kde se zobrazuje zůstatek
            const checkboxes = document.querySelectorAll('.legend-checkbox');
            const balanceDisplay = document.getElementById('main-balance-display');

            // Funkce, která přepočítá a zobrazí nový zůstatek
            function updateBalance() {
                let currentTotal = 0;
                
                // Projdeme všechny checkboxy
                checkboxes.forEach(function(checkbox) {
                    // Pokud je checkbox zaškrtnutý...
                    if (checkbox.checked) {
                        // ...přičteme jeho hodnotu k celkovému součtu
                        currentTotal += parseInt(checkbox.dataset.value, 10);
                    }
                });

                // Zformátujeme číslo (např. 33375 na "33 375") a přidáme "Kč"
                balanceDisplay.textContent = currentTotal.toLocaleString('cs-CZ') + 'Kč';
            }

            // Přidáme každému checkboxu "posluchače", který při změně zavolá naši funkci
            checkboxes.forEach(function(checkbox) {
                checkbox.addEventListener('change', updateBalance);
            });

            // Zavoláme funkci hned na začátku, aby se zobrazil počáteční součet
            updateBalance();
        });
    </script>

</body>
</html>